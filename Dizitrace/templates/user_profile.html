{% extends 'mainbase.html' %}
{%block content%}
<!DOCTYPE html>
{%load static%}
{%for i in res_token%}
{%if i.organization_id == '1' %}
      {%if i.role == '7' %}

      <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

<style>
/*******************************
* MODAL AS LEFT/RIGHT SIDEBAR
* Add "left" or "right" in modal parent div, after class="modal".
* Get free snippets on bootpen.com
*******************************/
.modal.left .modal-dialog,
.modal.right .modal-dialog {
  position: fixed;
  margin: auto;
  width: 320px;
  height: 100%;
  -webkit-transform: translate3d(0%, 0, 0);
      -ms-transform: translate3d(0%, 0, 0);
       -o-transform: translate3d(0%, 0, 0);
          transform: translate3d(0%, 0, 0);
}

.modal.left .modal-content,
.modal.right .modal-content {
  height: 100%;
  overflow-y: auto;
}

.modal.left .modal-body,
.modal.right .modal-body {
  padding: 15px 15px 80px;
}

/*Left*/
.modal.left.fade .modal-dialog{
  left: -320px;
  -webkit-transition: opacity 0.3s linear, left 0.3s ease-out;
     -moz-transition: opacity 0.3s linear, left 0.3s ease-out;
       -o-transition: opacity 0.3s linear, left 0.3s ease-out;
          transition: opacity 0.3s linear, left 0.3s ease-out;
}

.modal.left.fade.in .modal-dialog{
  left: 0;
}

/*Right*/
.modal.right.fade .modal-dialog {
  right: -320px;
  -webkit-transition: opacity 0.3s linear, right 0.3s ease-out;
     -moz-transition: opacity 0.3s linear, right 0.3s ease-out;
       -o-transition: opacity 0.3s linear, right 0.3s ease-out;
          transition: opacity 0.3s linear, right 0.3s ease-out;
}

.modal.right.fade.in .modal-dialog {
  right: 0;
}

/* ----- MODAL STYLE ----- */
.modal-content {
  border-radius: 0;
  border: none;
}

.modal-header {
  border-bottom-color: #EEEEEE;
  background-color: #FAFAFA;
}

/* ----- v CAN BE DELETED v ----- */
body {
background-color: #78909C;
}

.demo {
padding-top: 60px;
padding-bottom: 110px;
}

.btn-demo {
margin: 15px;
padding: 10px 15px;
border-radius: 0;
font-size: 16px;
background-color: #FFFFFF;
}

.btn-demo:focus {
outline: 0;
}

.demo-footer {
position: fixed;
bottom: 0;
width: 100%;
padding: 15px;
background-color: #212121;
text-align: center;
}

.demo-footer > a {
text-decoration: none;
font-weight: bold;
font-size: 16px;
color: #fff;
}
li.line
{
  display:inline-block;
}
</style>


{%for message in messages%}
<script>
window.onload = function() {
  alert('{{message}}');
}
</script>
{%endfor%}


      <style>
      body {
      background-color:#e6e6ff;
      }
      </style>
      </head>


      <body class="loginPage">
        <div class="content-wrapper">
                  <!-- Content Header (Page header) -->
                  <section class="content-header">
        <section class="content-header">
        <!-- <h1>Search Product -
          <small>Track & Trace</small>
        </h1> -->
        <ol class="breadcrumb">
          <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
          <!-- <li><a href="<?php echo base_url('dashboard') ?>"><i class="fa fa-dashboard"></i> Home</a></li> -->
          <!-- <li><a href="{%url 'dashboard1'%}"><i class="fa fa-dashboard"></i> Home</a></li> -->
          <li><a href="{% url 'dashboard1'%}"><i class="fa fa-dashboard"></i> Home</a></li>
        <li class="active"><a href="{% url 'add_user'%}">Add User</a></li>
        <li class="active"><a href="">Manage Users</a></li>
        </ol>
      </section>

        <div class="container" style="margin-top: 40px;background-color:white;width:103%;">
            <div class="row" style="background-color:white;">
                <div class="col-md-12" style="background-color:white;">

<h2 class="text-uppercase" style="font-family: 'Nunito Sans', sans-serif;font-size: 15px;margin-bottom: 5px;margin-left: 15px;font-weight: bold;margin-top: 3px;">Manage Users</h2>
	<div class="text-left">

{% for a in result2 %}

  <div style="padding: 7px;background: #e8e8e8;border-style: none;border-bottom-style: none;border-bottom-color: rgb(181,181,181);border-radius: 3px;border-top-left-radius: 3px;border-top-right-radius: 3px;border-bottom-right-radius: 3px;border-bottom-left-radius: 3px;margin-bottom: 3px;margin-left: 15px;">
<li class="line">
    <h2 style="font-family: 'Nunito Sans', sans-serif;font-size: 15px;margin-bottom: 0px;margin-top:0px;width:60px;">
      <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icon-tabler-user" style="padding: 13px;font-size: 50px;border-radius: 50%;background: #ffffff;margin-right: 5px;margin-bottom:3px;">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <circle cx="12" cy="7" r="4"></circle>
            <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"></path>
        </svg></h2>
</li>
<li class="line" style="width:400px;">
<h2 style="font-family: 'Open Sans', sans-serif;color:blue;font-size: 16px;margin-bottom: 0px;margin-left: 10px;margin-top: -50px;width:10px;">{{a.user_name}}</h2>
    <h2 style="font-family: 'Open Sans', sans-serif;font-size: 13px;margin-bottom: 0px;margin-left: 10px;margin-top: 5px;"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icon-tabler-mail" style="margin-right: 3px;margin-top: 0px;margin-bottom: 1px;font-size: 11px;">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <rect x="3" y="5" width="18" height="14" rx="2"></rect>
            <polyline points="3 7 12 13 21 7"></polyline>
        </svg>{{a.email}}
      </h2>

</li>
<li class="line">
  <h2 style="font-family: 'Nunito Sans', sans-serif;font-size: 11px;margin-bottom: 0px;padding-left: 200px;margin-top: 5px;">
      <!-- <script>var profileid = {{a.id}}</script> -->
      <!-- <input type="text" id="inputvalue" name="" value="{{a.id}}"> -->
      <button onclick="updatevalue({{a.id}})"  class="btn btn-primary clickme" role="button" data-toggle="modal" data-target="#myModal2" style="border-radius: 2px;font-size: 14px;padding: 5px 13px;padding-bottom: 4px;padding-top: 4px;padding-right: 11px;padding-left: 11px;background: #343434;font-family: 'Nunito Sans', sans-serif;border-style: none;border-color: #0f2b5b;"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icon-tabler-user-check" style="margin-right: 3px;margin-top: 0px;margin-bottom: 4px;">
                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"></path>
                <path d="M16 11l2 2l4 -4"></path>
            </svg>Edit</button>
            <a href="/delete/{{a.id}}">
              <button class="btn btn-primary" data-toggle="modal" type="button" style="border-radius: 2px;font-size: 14px;padding: 5px 13px;padding-bottom: 4px;padding-top: 4px;padding-right: 11px;padding-left: 11px;background: #ea361e;border-style: none;border-color: #181818;font-family: 'Nunito Sans', sans-serif;margin-left: 5px;"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icon-tabler-user-off" style="margin-right: 3px;margin-top: 0px;margin-bottom: 4px;">
                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                <path d="M14.274 10.291a4 4 0 1 0 -5.554 -5.58m-.548 3.453a4.01 4.01 0 0 0 2.62 2.65"></path>
                <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 1.147 .167m2.685 2.681a4 4 0 0 1 .168 1.152v2"></path>
                <line x1="3" y1="3" x2="21" y2="21"></line>
            </svg>Delete</button>
          </a>
        </h2>
</li>

  </button>
</div>
{%endfor%}
</div>
</div>
	</div>
</div>

	<!-- Modal -->

	<div class="modal left fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
		<div class="modal-dialog" role="document">
			<div class="modal-content">


			</div><!-- modal-content -->
		</div><!-- modal-dialog -->
	</div><!-- modal -->

	<!-- Modal -->
  <!-- <div class="offcanvas offcanvas-end" tabindex="-1"  style="background: rgba(0,0,0,0.75);backdrop-filter:blur(25px);"> -->
	<div class="modal right fade" id="myModal2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel4" style="background: rgba(0,0,0,0.75);backdrop-filter:blur(0px);">
		<div class="modal-dialog" role="document" style="width:35%">
			<div class="modal-content" style="width:100%;background: black; ">

				<div class="modal-body">
					<button type="button"  class="close" data-dismiss="modal" aria-label="Close" style="color:white;"><span aria-hidden="true" ><p style="color:#FFFFFF;">&times;</p></span></button>
					<h5 class="offcanvas-title" style="font-family: 'Nunito Sans', sans-serif;font-weight: bold;color: #d1d1d1;font-size:20px;">Update User</h5>



				<div class="modal-body" id="updatedata">
					<p> <div class="offcanvas-body"  style="padding-top: 35px;">
                    <!-- <form method="PUT" action="/updateuser/"> -->
                      <form method="PUT" id="updatedetails">
                        <p style="color:white;font-size:16px;font-weight:bold;">Username</p>
                      <input class="form-control" type="text" name="username" id="user_username" placeholder="Username"  style="margin-bottom: 5px;color: #adadad;background: #575757;border-style: none;color:white;font-size:16px;">
                    <p style="color:white;font-size:16px;font-weight:bold;">First Name</p>
                      <input class="form-control" type="text" name="first_name" id="user_first_name" placeholder="First Name" style="margin-bottom: 5px;color: #adadad;background: #575757;border-style: none;color:white;font-size:16px;">
                      <p style="color:white;font-size:16px;font-weight:bold;">Last Name</p>
                      <input class="form-control" type="text" name="last_name" id="user_last_name" placeholder="Last Name" style="margin-bottom: 15px;color: #adadad;background: #575757;border-style: none;color:white;font-size:16px;">
                      <!-- <p style="color:white;font-size:16px;font-weight:bold;">Contact Number</p> -->
                      <!-- <input class="form-control" type="tel" name="contact_number" id="user_contact_number" placeholder="Contact Number" style="margin-bottom: 5px;color: #adadad;background: #575757;border-style: none;color:white;font-size:16px;"> -->
                      <p style="color:white;font-size:16px;font-weight:bold;">Email</p>
                      <input class="form-control" type="email" name="email" id="user_profile_email" placeholder="Email" style="margin-bottom: 5px;color: #adadad;background: #575757;border-style: none;color:white;font-size:16px;">
                      <!-- <p style="color:white;font-size:16px;font-weight:bold;">Alternate Email</p> -->
                      <!-- <input class="form-control" type="email" id="user_alternate_email" name="alternate_email" placeholder="Alternate Email" style="margin-bottom: 15px;color: #adadad;background: #575757;border-style: none;color:white;font-size:16px;"> -->
                      <p style="color:white;font-size:16px;font-weight:bold;">Modified by</p>
                      <input class="form-control" type="text" id="modified_by" name="modified_by" placeholder="Modified by" style="margin-bottom: 15px;color: #adadad;background: #575757;border-style: none;color:white;font-size:16px;">
                      <!-- <p style="color:white;font-size:16px;font-weight:bold;">Password</p> -->
                      <!-- <input class="form-control" type="password" name="password" id="user_password" placeholder="Password" style="margin-bottom: 5px;color: #adadad;background: #575757;border-style: none;color:white;font-size:16px;"></form> -->
                      <input type="hidden" id="userhiddenid" name="">
                      <!-- <input type="text" name="" value="{{resultid.email}}" > -->
                      <p style="color:white;font-size:16px;font-weight:bold;">Select Role</p>
                      <select class="form-select" name="role" id="user_role" style="color: #adadad;width: 420px;height: 33px;margin-bottom: 5px;background: #575757;border-style: none;color:white;font-size:16px;">
                        <option selected>--Select Role--</option>
                        <option value="1">Operator</option>
                        <option value="2">Executive</option>
                        <option value="3">Manager</option>
                        </select>
                    <div style="margin-top: 15px;">
                      <!-- <a href="/updateuser/{{a.id}}"> -->
                      <button class="btn btn-primary" onclick="updatefunction()" role="button" style="border-radius: 2px;font-size: 14px;padding: 5px 13px;padding-bottom: 4px;padding-top: 4px;padding-right: 11px;padding-left: 11px;background: #009e49;font-family: 'Open Sans', sans-serif;border-style: none;border-color: #0f2b5b;"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icon-tabler-checks" style="margin-right: 3px;margin-top: 0px;margin-bottom: 1px;">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path d="M7 12l5 5l10 -10"></path>
                                <path d="M2 12l5 5m5 -5l5 -5"></path>
                            </svg>Update</button>
                          <!-- </a> -->
                          </div>
                </div>
              </form>
              	</p>
				</div>

			</div><!-- modal-content -->
		</div><!-- modal-dialog -->
	</div><!-- modal -->


</div><!-- container -->


      </section>
    </div>
      </body>



      <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
       <script>

       async function updatevalue(id){
         // var updatedid = $("#idget").val()
         // var updatedid = document.getElementById("#idget");
         var updateid = id

         // console.log(updateid)
         let url2 = "http://www.tracepharm.io:8000/update_user/" + updateid ;
         // console.log(url2)
         await $.get(url2, function(data, status){
             data=JSON.stringify(data)
             // console.log(data)
             res = JSON.parse(data)
             // console.log(res)
             $("#user_profile_email").val(res.email)
             $("#user_username").val(res.user_name)
             $("#user_first_name").val(res.first_name)
             $("#user_last_name").val(res.last_name)
             $("#user_contact_number").val(res.contact_number)
             $("#alternate_email").val(res.alternateemail)
             $("#user_password").val(res.password)
             $("#user_role").val(res.role)
             $("#userhiddenid").val(res.id)
             // $("#modified_by").val(res.id)


             // console.log(url2)
             // console.log(obj1)
         });

       }

       function updatefunction(){
         // console.log(profileid)

         var updatedata
                  user_name = $('#user_username').val();
                  first_name = $('#user_first_name').val();
                  last_name = $('#user_last_name').val();
                  email = $('#user_profile_email').val();
                  role = $('#user_role').val();
                  // contact_number = $('#user_contact_number').val();
                  // alternate_email = $('#user_alternate_email').val();
                  // password = $('#user_password').val();
                  modified_by = $('#modified_by').val();
                  id=$("#userhiddenid").val();
                  // console.log(user_name)
                  // console.log(first_name)
                  // console.log(last_name)
                  // console.log(email)
                  // console.log(role)
                  // console.log(id)
                  // console.log(modified_by)
                $.ajax({
                    url: "http://www.tracepharm.io:8000/update_user/"+id+"/",
                    // console.log(url)
                    type: 'PUT',
                    contentType: "application/json; charset=utf-8",
                    dataType: 'json',
                    data: updatedata,
                    // console.log(data)
                    success: function (data, textStatus, xhr) {
                        // console.log(data);
                    },
                    error: function (xhr, textStatus, errorThrown) {
                        // console.log('Error in Operation');
                        // console.log("Error ", errorThrown)
                        // console.log("TextStatus ", textStatus)
                        // console.log("XHR ", xhr)
                    }

         });
       }

       $(".close").click(function(){
  $("#updatedetails").reset();
});


       </script>



{%endif%}




{%endif%}
{%endfor%}
{%endblock%}
